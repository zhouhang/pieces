<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>账户信息-boss-饮片B2B</title>
    <meta name="renderer" content="webkit" />
    <link rel="stylesheet" href="css/style.css" />
</head>

<body>

    <!-- header start -->
    <div class="header">
        <div class="wrap">
            <div class="logo">
                <a href="home.html">药优优电子商务管理系统</a>
            </div>
            <div class="user">
                <span>登录用户 hehuan</span>
                <i>|</i>
                <span>2016年6月20日 星期三</span>
                <i>|</i>
                <a href="logout.html">退出</a>
            </div>
        </div>
    </div><!-- header end -->


    <!-- nav start -->
    <div class="nav">
        <div class="wrap">
            <ul>
                <li><a href="home.html">首页</a></li>
                <li>
                    <a href="#!">销售</a>
                    <div class="subnav">
                        <a href="enquiry.html">询价管理</a>
                        <a href="order.html">订单管理</a>
                    </div>
                </li>
                <li>
                    <a href="#!">目录</a>
                    <div class="subnav">
                        <a href="goods.html">商品管理</a>
                        <a href="category.html">分类管理</a>
                        <a href="breed.html">品种管理</a>
                    </div>
                </li>
                <li>
                    <a class="curr" href="#!">客户</a>
                    <div class="subnav">
                        <a href="customers.html">客户管理</a>
                    </div>
                </li>
                <li><a href="#!">促销</a></li>
                <li><a href="#!">邮件列表</a></li>
                <li><a href="#!">CMS</a></li>
                <li><a href="#!">报表</a></li>
                <li>
                    <a href="#!">系统</a>
                    <div class="subnav">
                        <a href="user.html">用户管理</a>
                        <a href="role.html">角色管理</a>
                    </div>
                </li>
            </ul>
        </div>
    </div><!-- nav end -->


    <!-- fa-floor start -->
    <div class="fa-floor">
        <div class="wrap">
            <div class="side">
                <dl>
                    <dt>客户信息</dt>
                    <dd>
                        <a href="customers-info.html">客户界面</a>
                        <a href="customers-account.html">账户信息</a>
                        <a class="curr" href="customers-certificate.html">企业资质</a>
                    </dd>
                </dl>
            </div>
            <div class="main">
                <form action="" id="myform">
                    <div class="title">
                        <h3><i class="fa fa-people"></i>hehuan</h3>
                        <div class="extra">
                            <button type="button" class="btn btn-gray" onclick="javascript:history.go(-1);">返回</button>
                            <button type="reset" class="btn btn-gray">重置</button>
                            <button type="button" class="btn btn-red" id="submit1">保存</button>
                        </div>
                    </div>

                    <div class="user-info">
                        <h3>企业基础信息</h3>
                        <div class="fa-form">
                            <div class="group">
                                <div class="txt">
                                    <i>*</i>企业名称：
                                </div>
                                <div class="cnt">
                                    <input class="ipt" value="" autocomplete="off" name="companyName" id="companyName" placeholder="营业执照上的企业名称全称" type="text">
                                    <span class="error1"></span>
                                </div>
                            </div>

                            <div class="group">
                                <div class="txt">
                                    <i>*</i>企业负责人：
                                </div>
                                <div class="cnt">
                                    <input class="ipt" value="" autocomplete="off" name="legalPerson" id="legalPerson" placeholder="营业执照上法人姓名" type="text">
                                    <span class="error1"></span>
                                </div>
                            </div>
                            <div class="group">
                                <div class="txt">
                                    <i>*</i>企业所在地：
                                </div>
                                <div class="cnt">
                                    <input class="ipt" value="" autocomplete="off" name="companyRegion" id="companyRegion" placeholder="营业执照上的企业所在地地址" type="text">
                                    <span class="error1"></span>
                                </div>
                            </div>
                            <div class="group group-cbx">
                                <div class="txt">
                                    <i>*</i>企业类型：
                                </div>
                                <div class="cnt">
                                    <label><input type="radio" name="category" class="cbx" value="" data-type="0,3,4" checked="">单体药店</label>
                                    <label><input type="radio" name="category" class="cbx" value="" data-type="">连锁药店</label>
                                    <label><input type="radio" name="category" class="cbx" value="" data-type="">公立医院</label>
                                    <label><input type="radio" name="category" class="cbx" value="" data-type="">民营医院</label>
                                    <label><input type="radio" name="category" class="cbx" value="" data-type="">个体诊所</label>
                                    <label><input type="radio" name="category" class="cbx" value="" data-type="">社区医疗机构</label>
                                </div>
                                <span class="error1" id="categoryError"></span>
                            </div>
                        </div>
                    </div>
                    <div class="user-info">
                        <h3>企业资质</h3>
                        <div class="tab">
                            <span class="curr">企业三证</span>
                            <span>三证合一</span>
                            <strong><em>提示：</em>如果客户的营业执照是老证，选择企业三证，如果是新证，选择三证合一。</strong>
                        </div>
                        <div class="tabcont fa-form">
                            <div class="box">
                                <div class="group group-val">
                                    <div class="txt">
                                        <i>*</i>证件名称：
                                    </div>
                                    <div class="cnt">
                                        <span class="val">营业执照</span>
                                    </div>
                                </div>
                                <div class="group">
                                    <div class="txt">
                                        <i>*</i>证件号：
                                    </div>
                                    <div class="cnt">
                                        <input class="ipt" value="" autocomplete="off" name="cardID_1" placeholder="" type="text" data-msg="{empty: '请输入证件号', error: '证件号字符长度2到50个字符！'}">
                                        <span class="error1"></span>
                                    </div>
                                </div>
                                <div class="group group-a">
                                    <div class="txt">
                                        <i>*</i>有效期：
                                    </div>
                                    <div class="cnt">
                                        <input class="ipt date" value="" autocomplete="off" name="indate_1" placeholder="2016/1/1 - 2016/5/8" type="text" data-msg="{empty: '请输入证件有效期', error: '证件号有效期长度2到50个字符！'}">
                                        <span class="error1"></span>
                                        <label><input type="checkbox" name="timeless_1" class="cbx">长期</label>
                                    </div>
                                </div>
                                <div class="group group-up">
                                    <div class="txt">
                                        <i>*</i>证件照片：
                                    </div>
                                    <div class="cnt">
                                        <span class="goods-img upimg thumb"></span>
                                        <input type="hidden" name="img_1" class="ipt" data-msg="{empty: '请上传证件照片'}">
                                        <span class="error1"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="box">
                                <div class="group group-val">
                                    <div class="txt">
                                        <i>*</i>证件名称：
                                    </div>
                                    <div class="cnt">
                                        <span class="val">组织机构代码证</span>
                                    </div>
                                </div>
                                <div class="group">
                                    <div class="txt">
                                        <i>*</i>证件号：
                                    </div>
                                    <div class="cnt">
                                        <input class="ipt" value="" autocomplete="off" name="cardID_2" placeholder="" type="text" data-msg="{empty: '请输入证件号', error: '证件号字符长度2到50个字符！'}">
                                        <span class="error1"></span>
                                    </div>
                                </div>
                                <div class="group group-a">
                                    <div class="txt">
                                        <i>*</i>有效期：
                                    </div>
                                    <div class="cnt">
                                        <input class="ipt date" value="" autocomplete="off" name="indate_2" placeholder="2016/1/1 - 2016/5/8" type="text" data-msg="{empty: '请输入证件有效期', error: '证件号有效期长度2到50个字符！'}">
                                        <span class="error1"></span>
                                        <label><input type="checkbox" name="timeless_2" class="cbx">长期</label>
                                    </div>
                                </div>
                                <div class="group group-up">
                                    <div class="txt">
                                        <i>*</i>证件照片：
                                    </div>
                                    <div class="cnt">
                                        <span class="goods-img upimg thumb"></span>
                                        <input type="hidden" name="img_2" class="ipt" data-msg="{empty: '请上传证件照片'}">
                                        <span class="error1"></span>
                                    </div>
                                </div>
                            </div>
                            <div class="box">
                                <div class="group group-val">
                                    <div class="txt">
                                        <i>*</i>证件名称：
                                    </div>
                                    <div class="cnt">
                                        <span class="val">税务登记证</span>
                                    </div>
                                </div>
                                <div class="group">
                                    <div class="txt">
                                        <i>*</i>证件号：
                                    </div>
                                    <div class="cnt">
                                        <input class="ipt" value="" autocomplete="off" name="cardID_3" placeholder="" type="text" data-msg="{empty: '请输入证件号', error: '证件号字符长度2到50个字符！'}">
                                        <span class="error1"></span>
                                    </div>
                                </div>
                                <div class="group group-a">
                                    <div class="txt">
                                        <i>*</i>有效期：
                                    </div>
                                    <div class="cnt">
                                        <input class="ipt date" value="" autocomplete="off" name="indate_3" placeholder="2016/1/1 - 2016/5/8" type="text" data-msg="{empty: '请输入证件有效期', error: '证件号有效期长度2到50个字符！'}">
                                        <span class="error1"></span>
                                        <label><input type="checkbox" name="timeless_3" class="cbx">长期</label>
                                    </div>
                                </div>
                                <div class="group group-up">
                                    <div class="txt">
                                        <i>*</i>证件照片：
                                    </div>
                                    <div class="cnt">
                                        <span class="goods-img upimg thumb"></span>
                                        <input type="hidden" name="img_3" class="ipt" data-msg="{empty: '请上传证件照片'}">
                                        <span class="error1"></span>
                                    </div>
                                </div>
                            </div>

                            <div class="box">
                                <div class="group group-val">
                                    <div class="txt">
                                        <i>*</i>证件名称：
                                    </div>
                                    <div class="cnt">
                                        <span class="val">GSP/GMP证书</span>
                                    </div>
                                </div>
                                <div class="group">
                                    <div class="txt">
                                        <i>*</i>证件号：
                                    </div>
                                    <div class="cnt">
                                        <input class="ipt" value="" autocomplete="off" name="cardID_4" placeholder="" type="text" data-msg="{empty: '请输入证件号', error: '证件号字符长度2到50个字符！'}">
                                        <span class="error1"></span>
                                    </div>
                                </div>
                                <div class="group group-a">
                                    <div class="txt">
                                        <i>*</i>有效期：
                                    </div>
                                    <div class="cnt">
                                        <input class="ipt date" value="" autocomplete="off" name="indate_4" placeholder="2016/1/1 - 2016/5/8" type="text" data-msg="{empty: '请输入证件有效期', error: '证件号有效期长度2到50个字符！'}">
                                        <span class="error1"></span>
                                        <label><input type="checkbox" name="timeless_4" class="cbx">长期</label>
                                    </div>
                                </div>
                                <div class="group group-up">
                                    <div class="txt">
                                        <i>*</i>证件照片：
                                    </div>
                                    <div class="cnt">
                                        <span class="goods-img upimg thumb"></span>
                                        <input type="hidden" name="img_4" class="ipt" data-msg="{empty: '请上传证件照片'}">
                                        <span class="error1"></span>
                                    </div>
                                </div>
                                <div class="group group-up">
                                    <div class="txt">
                                        资质变更记录表：
                                    </div>
                                    <div class="cnt thumb">
                                        <span class="goods-img upimgs"></span>
                                        <input type="hidden" name="img_alter_4" class="ipt">
                                        <p class="tips">如果您变更过企业资质，请上传资质变更记录表。</p>
                                    </div>
                                </div>
                            </div>

                            <div class="box">
                                <div class="group group-val">
                                    <div class="txt">
                                        <i>*</i>证件名称：
                                    </div>
                                    <div class="cnt">
                                        <span class="val">生产/经营许可证</span>
                                    </div>
                                </div>
                                <div class="group">
                                    <div class="txt">
                                        <i>*</i>证件号：
                                    </div>
                                    <div class="cnt">
                                        <input class="ipt" value="" autocomplete="off" name="cardID_4" placeholder="" type="text" data-msg="{empty: '请输入证件号', error: '证件号字符长度2到50个字符！'}">
                                        <span class="error1"></span>
                                    </div>
                                </div>
                                <div class="group group-a">
                                    <div class="txt">
                                        <i>*</i>有效期：
                                    </div>
                                    <div class="cnt">
                                        <input class="ipt date" value="" autocomplete="off" name="indate_4" placeholder="2016/1/1 - 2016/5/8" type="text" data-msg="{empty: '请输入证件有效期', error: '证件号有效期长度2到50个字符！'}">
                                        <span class="error1"></span>
                                        <label><input type="checkbox" name="timeless_4" class="cbx">长期</label>
                                    </div>
                                </div>
                                <div class="group group-up">
                                    <div class="txt">
                                        <i>*</i>证件照片：
                                    </div>
                                    <div class="cnt">
                                        <span class="goods-img upimg thumb"></span>
                                        <input type="hidden" name="img_5" class="ipt" data-msg="{empty: '请上传证件照片'}">
                                        <span class="error1"></span>
                                    </div>
                                </div>
                            </div>

                            <div class="box">
                                <div class="group group-val">
                                    <div class="txt">
                                        <i>*</i>证件名称：
                                    </div>
                                    <div class="cnt">
                                        <span class="val">医疗机构经营许可证</span>
                                    </div>
                                </div>
                                <div class="group">
                                    <div class="txt">
                                        <i>*</i>证件号：
                                    </div>
                                    <div class="cnt">
                                        <input class="ipt" value="" autocomplete="off" name="cardID_4" placeholder="" type="text" data-msg="{empty: '请输入证件号', error: '证件号字符长度2到50个字符！'}">
                                        <span class="error1"></span>
                                    </div>
                                </div>
                                <div class="group group-a">
                                    <div class="txt">
                                        <i>*</i>有效期：
                                    </div>
                                    <div class="cnt">
                                        <input class="ipt date" value="" autocomplete="off" name="indate_4" placeholder="2016/1/1 - 2016/5/8" type="text" data-msg="{empty: '请输入证件有效期', error: '证件号有效期长度2到50个字符！'}">
                                        <span class="error1"></span>
                                        <label><input type="checkbox" name="timeless_4" class="cbx">长期</label>
                                    </div>
                                </div>
                                <div class="group group-up">
                                    <div class="txt">
                                        <i>*</i>证件照片：
                                    </div>
                                    <div class="cnt">
                                        <span class="goods-img upimg thumb"></span>
                                        <input type="hidden" name="img_6" class="ipt" data-msg="{empty: '请上传证件照片'}">
                                        <span class="error1"></span>
                                    </div>
                                </div>
                                <div class="group group-up">
                                    <div class="txt">
                                        资质变更记录表：
                                    </div>
                                    <div class="cnt thumb">
                                        <span class="goods-img upimgs"></span>
                                        <input type="hidden" name="img_alter_6" class="ipt">
                                        <p class="tips">如果您变更过企业资质，请上传资质变更记录表。</p>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </form>
            </div>
        </div><!-- fa-floor end -->
    </div>


    <!-- footer start -->
    <div class="footer">
        <div class="wrap">            
            <div class="copyright">
                <p>药优优电商管理系统 版本 1.0  版权所有 &copy; 2016 药优优</p>
            </div>
        </div>
    </div><!-- footer end -->

    <script src="js/jquery.min.js"></script>
    <script src="js/lightbox.js"></script>
    <script src="js/layer/layer.js"></script>
    <script src="js/croppic.min.js"></script>
    <script src="js/common.js"></script>
    <script>
    !(function($) {
        var page = {
            v: {
                id: "page"
            },
            fn: {
                init: function () {
                    this.certificate();
                    this.bindEvent();
                    this.submitForm();
                    this.upfileImg();
                },
                certificate: function() {
                    var $input = $('#myform').find('.cbx[name="category"]:checked'),
                        $box = $('.tabcont').find('.box'),
                        $tab = $('.tab');

                    $box.hide();
                    switch($input.parent().index()) {
                        case 0: 
                            $box.eq(0).show();
                            $box.eq(3).show();
                            $box.eq(4).show();
                            $tab.hide();
                            break;
                        case 1: 
                            $box.eq(0).show();
                            $box.eq(1).show();
                            $box.eq(2).show();
                            $box.eq(3).show();
                            $box.eq(4).show();
                            $tab.show();
                            break;
                        case 2: 
                        case 3: 
                        case 4: 
                        case 5: 
                            $box.eq(5).show();
                            $tab.hide();
                            break;
                        //  no default
                    } 
                },
                bindEvent: function() {
                    var self = this;
                        $myform = $('#myform'),
                        $box = $('.box');

                    // 三证合一
                    $myform.on('click', '.tab span', function() {
                        $(this).addClass('curr').siblings().removeClass('curr');
                        $box.hide();
                        if ($(this).index() === 1) {
                            $box.eq(0).show();
                            $box.eq(3).show();
                            $box.eq(4).show();
                        } else {
                            $box.eq(0).show();
                            $box.eq(1).show();
                            $box.eq(2).show();
                            $box.eq(3).show();
                            $box.eq(4).show();
                        }
                    })

                    // 长期
                    $myform.on('click', '.cbx', function() {
                        var $ipt = $(this).closest('.cnt').find('.ipt');
                        $ipt.prop('disabled', this.checked).val('').next().hide();
                    })

                    // 类型
                    $myform.find('.cbx[name="category"]').on('click', function() {
                        self.certificate();
                    })

                    // blur
                    $myform.on('blur', '.box .ipt', function() {
                        var len = this.value.length,
                            tips = eval('(' + $(this).data('msg') + ')'),
                            msg = '';

                        if (len == 0) {
                            msg = '<i class="fa fa-prompt"></i> ' + tips.empty;
                        } else if (len < 2 || len > 50) {
                            msg = '<i class="fa fa-prompt"></i> ' + tips.error;
                        } 
                        $(this).next().html(msg)[msg == '' ? 'hide' : 'show']();
                    })

                    $('#companyName').on('blur', function() {
                        self.checkCompName();
                    })
                    $('#legalPerson').on('blur', function() {
                        self.checklegalPerson();
                    })
                    $('#companyRegion').on('blur', function() {
                        self.checkcompanyRegion();
                    })
                },
                checkCompName: function() {
                    var $input = $('#companyName'),
                        length = $input.val().length,
                        msg = '';
                    if (length == 0) {
                        msg = '<i class="fa fa-prompt"></i> 请输入企业名称';
                    } else if (!/^([a-zA-Z0-9_\(\)-]|[\u4e00-\u9fa5]|[（）]){4,50}$/.test($input.val())) {
                        msg = '<i class="fa fa-prompt"></i> 企业名称长度4-50，只能由中英文、数字及\"_\"、\"-\"、()、（）组成';
                    }
                    $input.next().html(msg)[msg == '' ? 'hide' : 'show']();
                    msg && $input.focus();
                    return msg === '';
                },
                checklegalPerson: function() {
                    var $input = $('#legalPerson'),
                        length = $input.val().length,
                        msg = '';
                    if (length == 0) {
                        msg = '<i class="fa fa-prompt"></i> 请输入企业负责姓名';
                    } else if (length < 4 || length > 50) {
                        msg = '<i class="fa fa-prompt"></i> 企业责任人长度4-50位';
                    }
                    $input.next().html(msg)[msg == '' ? 'hide' : 'show']();
                    msg && $input.focus();
                    return msg === '';
                },
                checkcompanyRegion: function() {
                    var $input = $('#companyRegion'),
                        length = $input.val().length,
                        msg = '';
                    if (length == 0) {
                        msg = '<i class="fa fa-prompt"></i> 请输入企业所在地地址';
                    } else if (length < 4 || length > 50) {
                        msg = '<i class="fa fa-prompt"></i> 企业责任人长度4-150位';
                    }
                    $input.next().html(msg)[msg == '' ? 'hide' : 'show']();
                    msg && $input.focus();
                    return msg === '';
                },
                checkcategory: function() {
                    var $input = $('#myform').find('.cbx[name="category"]:checked'),
                        length = $input.length,
                        msg = '';
                    if (length == 0) {
                        msg = '<i class="fa fa-prompt"></i> 请选择企业类型';
                    }
                    $('#categoryError').html(msg)[msg == '' ? 'hide' : 'show']();
                    return msg === '';
                },
                formValidate: function() {
                    var $myform = $('#myform'),
                        $ipts = $myform.find('.box:visible .ipt'),
                        pass = true;

                    if (!this.checkcompanyRegion()) {
                        pass = false;
                    }
                    if (!this.checklegalPerson()) {
                        pass = false;
                    }
                    if (!this.checkCompName()) {
                        pass = false;
                    }
                    this.checkcategory();

                    $ipts.each(function() {
                        var len = this.value.length,
                            tips = eval('(' + $(this).data('msg') + ')'),
                            msg = '';

                        if ($(this).prop('disabled')) {
                            // do nothing
                        } else if (len == 0) {
                            msg = '<i class="fa fa-prompt"></i> ' + tips.empty;
                        } else if (len < 2 || len > 50) {
                            msg = '<i class="fa fa-prompt"></i> ' + tips.error;
                        }
                        $(this).next().html(msg)[msg == '' ? 'hide' : 'show']();
                        if (pass && msg != '') {
                            pass = false;
                            $(this).focus();
                        }
                    })

                    return pass;
                },
                submitForm: function() {
                    var self = this;
                    $('#submit1').on('click', function() {
                        if (self.formValidate()) {
                            alert('success')
                        } else {
                        }
                        return false;
                    })
                },
                // 商品图片
                upfileImg: function() {
                    var self = this,
                        split = '@@@',
                        wait = false,
                        type = 1,
                        $el,
                        $upimg = $('.goods-img');

                    // 多图删除
                    $('.thumb').on('click', '.upimgs .del', function() {
                        var $self = $(this);
                        layer.confirm('确认删除商品图片？', function(index) {
                            var $ipt = $self.closest('.thumb').find('input:hidden'),
                                url = $self.prev().attr('src'),
                                originImg = (split + $ipt.val()).replace(split + url, '').replace(split, '');
                            $ipt.val(originImg).prev().show();;
                            $self.parent().remove();
                            layer.close(index);
                        });
                    })

                    // 删除图片
                    $upimg.on('click', '.del', function() {
                        var $self = $(this);
                        layer.confirm('确认删除商品图片？', function(index){
                            $self.parent().empty().next(':hidden').val('');
                            layer.close(index);
                        });
                        return false;
                    })

                    $upimg.each(function() {
                        $(this).next().val('');
                        $(this).on('click', function() {
                            if (wait) {
                                return;
                            }
                            type = $(this).hasClass('upimgs') ? 2 : 1;
                            if (type === 2 && $(this).next().val().split(split).length > 2) {
                                $el = $('<div></div>');
                                $(this).hide();
                                $.notify({
                                    type: 'error',
                                    title: '最多只能添加3张变更记录表',
                                    delay: 3e3
                                });
                                return false;
                            }
                            $el = $(this);
                            $('#upImgForm').find('.cropControlUpload').trigger('click');
                        })
                    })

                    $('body').append('<div id="upImgForm" style="position:fixed;bottom:0;left:0;visibility:hidden;"></div>');

                    var upfile = new Croppic('upImgForm', {
                        uploadUrl: 'img_save_to_file.php',
                        onBeforeImgUpload: function() {
                            wait = true;
                            $el.html('<span class="loader">图片上传中...</span>');
                        },
                        onAfterImgUpload: function(response) {
                            if (type === 1) {
                                $el.show().html('<img src="' + response.url + '" /><i class="del" title="删除"></i>').next().val(response.url).trigger('validate');
                            } else {
                                var $ipt = $el.next();
                                var originImg = $ipt.val();
                                $el.empty().show().before('<span class="goods-img upimgs"><img src="' + response.url + '"><i class="del" title="删除"></i></span>');
                                if (originImg) {
                                    originImg += split + response.url;
                                } else {
                                    originImg = response.url;
                                }
                                if (originImg.split(split).length > 2) {
                                    $el.hide();
                                }
                                $ipt.val(originImg);
                            }
                            wait = false;
                        },
                        onError: function(msg) {
                            $el.html('<span class="upimg-msg">' + msg + '</span>');
                            wait = false;
                        }
                    });
                }
            }
        }
        //加载页面js
        $(function() {
            page.fn.init();
        });
    })(jQuery);
    </script>
</body>
</html>

<script>
// 以下js为本地导航模板代码，上线时请删掉
$(function() {
    $.ajax({
        url: 'nav.html',
        success: function(menu) {
            $('.nav').html(menu);

            var $side = $('.nav'),
                URL = document.URL.split('#')[0].split('?')[0].toLowerCase();

            $side.find('a').each(function() {
                if (URL === this.href.toLowerCase()) {
                    $(this).addClass("on").parent().prev().addClass('curr');
                    return false; // break
                }
            }) 
        }
    })
})
</script>